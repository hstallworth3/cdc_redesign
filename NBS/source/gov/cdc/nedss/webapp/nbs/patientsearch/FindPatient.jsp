<html>	<head>	    <base target="_self">	    <%@ include file="/jsp/tags.jsp" %>	    <%@ include file="/jsp/resources.jsp" %>		<meta http-equiv="MSThemeCompatible" content="yes"/>		<title>Contact Search</title>	        <SCRIPT Language="JavaScript" Src="/nbs/dwr/interface/JPropertyUtilClient.js"></SCRIPT>		<script type="text/javascript">		    var isFormSubmission = false;			window.onload = function() {				checkRadioType();				$j("body").find(':input:visible:enabled:first').focus();			}					if (typeof window.event != 'undefined')		  		document.onkeydown = function()		    {				var t=event.srcElement.type;				if(t == '' || t == 'undefined' || t == 'button') {					return;				}				var kc=event.keyCode;				//alert(kc + '  ' +  t);				if(t == 'text' && kc == 13) {					searchPatient();				}				    }		    function checkRadioType(){				if(getElementByIdOrByName("pat").checked){					switchSearchFields("pat");					}				if(getElementByIdOrByName("evt").checked){					switchSearchFields("evt");					}				if(getElementByIdOrByName("eplnk") != null && getElementByIdOrByName("eplnk").checked){					switchSearchFields("eplnk");					}			    }			function  searchPatient() {									var allEnabledSearchIpElts = $j("#qsearch").find(':input:enabled');					var atleastOne = false;					var validDob = true;					var errorMsgArray = new Array(); 					//alert(allEnabledSearchIpElts.length);			        for (var i = 0; i < allEnabledSearchIpElts.length; i++) {			            if ($j(allEnabledSearchIpElts[i]).attr("type") != 'radio' && $j(allEnabledSearchIpElts[i]).attr("type") != 'hidden' && $j(allEnabledSearchIpElts[i]).attr("type") != 'button' && jQuery.trim($j(allEnabledSearchIpElts[i]).attr("value")) !="" ) {								atleastOne = true;								//alert($j(allEnabledSearchIpElts[i]).attr("type") + $j(allEnabledSearchIpElts[i]).attr("value"));								if($j(allEnabledSearchIpElts[i]).attr("id") == 'DEM115') {									if (!isDate( $j(allEnabledSearchIpElts[i]).attr("value") ) ) {										errorText = "Date of Birth must be in the format of mm/dd/yyyy. Please correct the data and try again.";										errorMsgArray.push(errorText);										$j("#DEM115").focus();																			}								}			            }			        }				        if(!atleastOne) {			        	errorText = "Please enter at least one item to search.";			        	errorMsgArray.push(errorText);			        	$j("#DEM102").focus();	        				        				        }			        if($j("#ESR100").attr("value")!="" && $j("#ESR101").attr("value")=="") {			        	errorText = " Please enter an Event ID.";			        	errorMsgArray.push(errorText);  			        	$j("#ESR101").focus();			        	       			        }		        for (var i = 0; i < allEnabledSearchIpElts.length; i++) {				     if($j(allEnabledSearchIpElts[i]).attr("type") == 'button' && errorMsgArray.length == 0)				        $j(allEnabledSearchIpElts[i]).attr("disabled","disabled");		        }			     // display the errors in the error messages bar.                if(errorMsgArray!=null && errorMsgArray.length > 0){                    displayGlobalErrorMessage(errorMsgArray);                    return false;                }                blockUIDuringFormSubmissionNoGraphic();				document.patientSearchForm.action ="/nbs/PatientSearch.do?method=patientSearchSubmit";				isFormSubmission = true;				document.patientSearchForm.submit();				return true;			}					function radioToggleSearchFields(rad) {				var searchType = rad.id;   				switchSearchFields(searchType);					}			function switchSearchFields(searchType){				if(searchType == 'pat') {					clearEvent();					$j("#patientSearchByEvent").hide();						$j("#patientSearchByEpilink").hide();								$j("#patientSearchByDetails").show();							}				if(searchType == 'evt') {					clearPatient();					$j("#patientSearchByDetails").hide();					$j("#patientSearchByEpilink").hide();					$j("#patientSearchByEvent").show();							}				if(searchType == 'eplnk') {					clearPatient();					clearEvent();					$j("#patientSearchByEvent").hide();						$j("#patientSearchByDetails").hide();					$j("#patientSearchByEpilink").show();							}				}						function clearPatient() {		        var allEnabledSearchIpElts = $j("#patientSearchByDetails").find(':input:enabled');		        for (var i = 0; i < allEnabledSearchIpElts.length; i++) {		            if ($j(allEnabledSearchIpElts[i]).attr("type") != 'button') {		                $j(allEnabledSearchIpElts[i]).val("");		            }		        }				}					function clearEvent() {		        var allEnabledSearchIpElts = $j("#patientSearchByEvent").find(':input:enabled');		        for (var i = 0; i < allEnabledSearchIpElts.length; i++) {		            if ($j(allEnabledSearchIpElts[i]).attr("type") != 'button') {		                $j(allEnabledSearchIpElts[i]).val("");		            }		        }					showHideEventId();			}						function showHideEventId() {				$j('#ESR101').val('');				if($j('#ESR100').attr('value') == "")					$j('#ESR101TR').hide();					else {					$j('#ESR101TR').show();						$j('#ESR101').focus();						}						}					function closePopup()		    {			    if (isFormSubmission == false) {	                self.close();	                var opener = getDialogArgument();						                var pageId = '<%=request.getParameter("pageId")%>';   	                if(pageId == 'pageview')  	                	var invest =getElementByIdOrByNameNode("pageview", opener.document);	                else	                	var invest =getElementByIdOrByNameNode("pamview", opener.document);	                if (invest == null) {	                	invest =getElementByIdOrByNameNode("blockparent", opener.document);	                }	                if(invest!=null && invest!= undefined)	                	invest.style.display = "none";  	                opener.document.forms[0].action ="/nbs/LoadPatientSearch.do?method=Cancel";                    opener.document.forms[0].submit();                    	                return true;			    } 		    }					</script>	</head><body class="popup" onunload="closePopup()" style="overflow-x: hidden; padding-right: 15px">    <div class="popupTitle">            Contact Search         </div>  <div class="popupButtonBar">            <input type="submit" name="Search" value="Search" onclick="return searchPatient();""/>            <input type="button" name="Cancel" value="Cancel" onclick="closePopup();" />  </div>   <!-- error1 (error message block) -->        <div class="none" id="error1" style="width:100%; text-align:center;"> </div>           <!-- Error Messages using Action Messages-->    <div id="globalFeedbackMessagesBar" class="screenOnly">    	<logic:messagesPresent name="error_messages">        <div class="infoBox errors" id="errorMessages">            <b> <a name="errorMessagesHref"></a> Please fix the following errors:</b> <br/>            <ul>                <html:messages id="msg" name="error_messages">                    <li> <bean:write name="msg" /> </li>                </html:messages>            <ul>        </div>    </logic:messagesPresent>    </div>    <html:form action="/PatientSearch.do" styleId="nedssForm">         <div id="qsearch" >      <p style="text-align:left;">       <b>&nbsp;&nbsp;Search by:</b>       &nbsp;<html:radio property="patientSearch"  value="pat" styleId="pat" onclick="radioToggleSearchFields(this)"> Demographics </html:radio>        &nbsp;<html:radio property="patientSearch"  value="evt" styleId="evt" onclick="radioToggleSearchFields(this)">  Event </html:radio>              <c:if test="${patientSearchForm.attributeMap.isStdOrHivProgramArea}">        &nbsp; <html:radio property="patientSearch"  value="eplnk" styleId="eplnk" onclick="radioToggleSearchFields(this)"> Epi-Linked List </html:radio>        </c:if>                     </p>        <p style="margin-top:0.5em;">     <div id="patientSearchByDetails">                		<html:hidden property="patientSearchVO.lastNameOperator"/>        		<html:hidden property="patientSearchVO.firstNameOperator"/>						<html:hidden property="patientSearchVO.birthTimeOperator"/>                <table class="nedssBlueBG formTable" style="width:98%; margin:auto;">                 <tbody>                    <tr>                        <td class="fieldName" > Last Name: </td>                         <td> <html:text  property="patientSearchVO.lastName" styleId="DEM102" title="Patient's Last Name Contains"/> </td>                    </tr>                    <tr>                                                                            <td class="fieldName"> First Name: </td>                         <td> <html:text  property="patientSearchVO.firstName" styleId="DEM104" title="Patient's First Name Contains"/> </td>                    </tr>                    <tr>                            <td class="fieldName"> Date of Birth : </td> 		                <td>		                    <html:text size="10" property="patientSearchVO.birthTime" styleId="DEM115" maxlength="10" title="Patient's Date Of Birth Equals" onkeyup="DateMask(this,null,event)"/>		                    <html:img src="calendar.gif" onclick="getCalDate('DEM115','DEM115DateIcon'); return false;" styleId="DEM115DateIcon"/>		                </td>                    </tr>                    <tr>                        <td class="fieldName"> Current Sex: </td>                         <td>		                     <html:select name="patientSearchForm" property="patientSearchVO.currentSex" styleId="DEM114" title="Patient's Current Sex Equals" acomplete="false">		                        <html:optionsCollection property="codedValue(SEX)" value="key" label="value"/>		                    </html:select>	                                                                            </td>                    </tr>                    <tr>                        <td class="fieldName"> Patient ID: </td>                         <td> <html:text  property="patientSearchVO.localID" styleId="DEM229" title="Patient's ID Equals"/></td>                    </tr>                     </tbody>                                    </table>        </div>      <div id="patientSearchByEvent" style="display:none;">                <table class="searchTable" style="width:90%; margin:auto;">                 <tbody class="conditionControl">                    <tr>                        <td class="fieldName"> Event ID Type: </td>                         <td style="white-space:nowrap">		                     <html:select name="patientSearchForm" property="patientSearchVO.actType" styleId="ESR100" onchange="showHideEventId();" title="Please select the type of Event to search">		                        <html:optionsCollection property="codedValue(PHVS_EVN_SEARCH_ABC)" value="key" label="value"/>		                    </html:select>	                                                                            </td>                    </tr>                    <tr id="ESR101TR" class="none">                                                                            <td class="fieldName" class="conditionControl"> Event ID: </td>                         <td> <html:text  property="patientSearchVO.actId" styleId="ESR101" title="Please enter 'Event ID' with an exact match"/> </td>                    </tr>                    </tbody>	                                                                                    </table>                    </div>                <div id="patientSearchByEpilink" style="display:none;">                <table class="searchTable" style="width:90%; margin:auto;">                 <tbody class="conditionControl">                                     <b><bean:message key="patients.by.epilink"/> </b>                                                                                   </tbody>	                 </table>                     </div>      </p>  </html:form>  <!-- Bottom button bar -->            <div class="popupButtonBar">            <input type="submit" name="Search" value="Search" onclick="return searchPatient();"/>            <input type="button" name="Cancel" value="Cancel" onclick="closePopup();" />        </div>    </body></html>