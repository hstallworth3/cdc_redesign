<%@ page import = " gov.cdc.nedss.webapp.nbs.action.homepage.charts.ChartRenderer" %><%@ page import = " gov.cdc.nedss.webapp.nbs.action.homepage.charts.ChartElementDataSet" %><%@ page import = " gov.cdc.nedss.systemservice.util.DropDownCodeDT" %><%@ page import = "java.io.PrintWriter" %><%@ page import = "java.text.SimpleDateFormat" %><%@ page import = "java.util.ArrayList" %><%@ page import = "java.util.Date" %><%@ page import = "java.util.Iterator" %><%@ page import = "java.util.Locale" %><SCRIPT Language="JavaScript" Src="/nbs/dwr/interface/JCharts.js"></SCRIPT><script type="text/javascript">	function createChart(width,height) {		//alert('test' + $j('#charts').val());		var key = $j('#charts').val();		JCharts.generateJChart(key, width,height, function(data){});		}	function loadChart() {		JCharts.loadJChart(function(data){			//alert(data.chartNm);			var srcIco = '/nbs/DisplayChart?filename=' + data.chartNm;						if(data.chartNm != 'null') {				$j("#chartImg").attr("src", srcIco);						var clickAttr = "#" + data.chartNm;				$j("#chartImg").removeAttr("useMap");				$j("#chartImg").attr("useMap", clickAttr);				$j("#crdiv").append(data.mapHtml);			} else {				$j("#chartImg").attr("src", "nodata.gif");			}		$j("#chartitle").html(data.title);					$j("#chartImg").show();$j("#charts").show();$j("#magnify").show();		});		}		function refreshData() {		$j("#chartImg").hide();$j("#charts").hide();$j("#magnify").hide();$j("#chartitle").html("Generating Chart.....");		createChart(285,250);				setTimeout("loadChart()", 1000);	}	function maxChart(width,height) {		$j("#chartImg1").hide();$j("#chartitle1").html("Generating Chart.....");		createChart(width,height);				setTimeout("loadChartnW()", 1000);	}		function loadChartnW() {		JCharts.loadJChart(function(data){			//alert(data.chartNm);			var srcIco = '/nbs/DisplayChart?filename=' + data.chartNm;						if(data.chartNm != 'null') {				$j("#chartImg1").attr("src", srcIco);						var clickAttr = "#" + data.chartNm;				$j("#chartImg1").removeAttr("useMap");				$j("#chartImg1").attr("useMap", clickAttr);				$j("#popupContact").append(data.mapHtml);			} else {				$j("#chartImg1").attr("src", "nodata.gif");			}		$j("#chartitle1").html(data.title);				$j("#chartImg1").show();			});			}</script><div style="height:0px;width:0px;display:none;" id="crdiv">    <%        String graphURL = "";        ArrayList chartList = ChartElementDataSet.getAvailableChartList();        String dKey = request.getParameter("charts") == null ? "C001" : request.getParameter("charts");        String filename = ChartRenderer.generateChart(dKey, request, new PrintWriter(out));        if(filename != null && filename.endsWith(".gif"))            graphURL = filename;        else                graphURL = request.getContextPath() + "/DisplayChart?filename=" + filename;    %></div><nedss:dashlet id="myCharts" name="${chartTitle}" 	    isDraggable="true" headerClass="header dd-multi-handle-${colIndex}" 	    contentStyle="height:300px; text-align:center;background: White url('ajax-loader.gif') no-repeat center;"	    headerId="dd-handle-${colIndex}_${rowIndex}a">	<% if(filename != null && filename.equals("public_nodata.png")) { %>	<img src="nodata.gif"/>	<%} else {%>		<img id="chartImg" src="<%= graphURL %>" width="285" height="250" border="0" useMap="#<%= filename %>">		<%} %>	<br/>	<div align="center">		<select id="charts" class="pullDown" onchange="refreshData();">			<%								Iterator iter = chartList.listIterator();				while (iter.hasNext()) {								DropDownCodeDT dt = (DropDownCodeDT)iter.next();								if (dt.getKey().equals(dKey)) { %>									<option value=<%= dKey %> selected><%= dt.getValue()%></option>			<%					} else { %>									<option value=<%= dt.getKey() %>><%= dt.getValue()%></option>			<%					} %>			<%				} %>		</select>		<img id="magnify" src="magnify.jpg" alt="Magnify" onclick="javascript:maxChart(750,470);" style="cursor: pointer;text-decoration:none;"/>	</div>		</nedss:dashlet>	<div id="popupContact">  		  <img id="popupContactClose" src="close.gif" alt="Close" style="cursor: pointer;text-decoration:none;"/>         <h3 id="chartitle1">Nedss Charts</h3>           <p id="contactArea">  				<img id="chartImg1" border="0">         </p>       </div>          <div id="backgroundPopup"></div>  